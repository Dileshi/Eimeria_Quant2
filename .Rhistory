#Let me try my own plot
View(challenge.DNA)
##BEGIN with qPCR Data
if(!exists("challenge.DNA")){
source("R_Python_Scripts/2_Challange_infections/2_qPCR_Data_Prep.R")
}
View(challenge.DNA)
##BEGIN with qPCR Data
if(!exists("challenge.DNA.qpcr")){
source("R_Python_Scripts/2_Challange_infections/2_qPCR_Data_Prep.R")
}
##BEGIN with qPCR Data
if(!exists("challenge.DNA.qpcr")){
source("R_Python_Scripts/2_Challange_infections/2_qPCR_Data_Prep.R")
}
library(tidyverse)
library(dplyr)
library(tidyr)
#load qPCR data challenge infection and clean
DNA.data <- read.csv("Output_Data/qPCR_fecal_lab_challenge_merged.csv")
DNA.data <- rename (DNA.data, Cq_mean = Cq.Mean)
#create new column in dataframe in challenge to allow merge with DNA.data dataframe
#challenge dataframe new column named sample will contain labels without E57x or E57y to allow merge
challenge <- read.csv("Output_Data/All_parameters_merged_challenge.csv")
#subset required info
challenge %>%
select(labels, EH_ID, dpi,Conc_DNA,fecweight_DNA) -> challenge.DNA
#introduce new column named Sample containing 3-letter code
challenge.DNA$Sample = challenge.DNA$labels
challenge.DNA$Sample<-gsub("E57bx","",as.character(challenge.DNA$Sample))
challenge.DNA$Sample<-gsub("E57by","",as.character(challenge.DNA$Sample))
#merge qPCR data and sample data
challenge.DNA = left_join(DNA.data,challenge.DNA)
rm(DNA.data,challenge)
##BEGIN WITH qPCR data -> plot DNA using primary infection standard curve
##load standard curve (Josi)
if(!exists("data.std")){
source("R_Python_Scripts/1_Primary_Infections/2_qPCR_Data_Prep.R")
}
#rename: cohesive with other scripts
challenge.DNA <- rename (challenge.DNA, c(Ct = Cq, Tm = Tm1))
data.std <- rename (data.std, c(Tm = Tm1))
##PREDICT GENOME COPIES USING STANDARD
lm.data.std<- lm(log10(Genome_copies)~Cq_mean, data.std, na.action = na.exclude)
challenge.DNA$Genome_copies<- 10^predict(lm.data.std, challenge.DNA)
rm(lm.data.std,data.std)
challenge.DNA%>%
dplyr::select(Task,labels,Tm)%>%
dplyr::filter(Task%in%c("Pos_Ctrl"))%>%
dplyr::filter(complete.cases(.))%>%
dplyr::mutate(Tm = as.numeric(Tm))%>%
dplyr::summarise(mean = mean(Tm), sd= sd(Tm), n = n())%>%
dplyr::mutate(se = sd / sqrt(n),
lower.ci = mean - qt(1 - (0.05 / 2), n - 1) * se,
upper.ci = mean + qt(1 - (0.05 / 2), n - 1) * se)%>%
dplyr::mutate(upper.ran = mean + (2*sd),
lower.ran = mean - (2*sd))
##Positive controls have a Tm at:
#mean        sd n  se lower.ci upper.ci upper.ran lower.ran
#74.1 0.8944272 5 0.4 72.98942 75.21058  75.88885  72.31115
##The mean Tm is at 74.1Â°C and sd of 0.89
##Make all the things below/above Tm mean +/- 2sd negative
##Check which samples have the three triplicates "positive"
challenge.DNA %>%
dplyr::mutate(Infection = case_when(is.na(Tm)  ~ "Negative",
(Tm >= 76 | Tm <= 72.2)  ~ "Negative",
(Tm >=72.3 & Tm <= 75.9) ~ "Positive"))%>%
dplyr::group_by(labels)%>%
dplyr::summarise(Count.Tm= sum(Infection=="Positive"))%>%
dplyr::mutate(Infection = case_when(Count.Tm == 3 ~ "Positive",
Count.Tm != 3 ~ "Negative"))%>%
dplyr::left_join(challenge.DNA, by= "labels")-> challenge.DNA
##Eliminate an unprocessed sample and controls
challenge.DNA%>%
dplyr::mutate(Genome_copies = case_when((Infection=="Negative")~ 0,
TRUE~ Genome_copies))%>% ## Make Negative zero
dplyr::select(labels, Genome_copies, Tm, Infection,EH_ID,dpi,Cq_mean, Conc_DNA,fecweight_DNA)%>%
dplyr::filter(!labels%in%c("Pos_Ctrl","Neg_Ctrl"))%>% ## Replace NAs in real negative samples to 0
dplyr::mutate(Genome_copies= replace_na(Genome_copies, 0))%>%
dplyr::mutate(Tm= replace_na(Tm, 0))%>%
##Get unique labels from qPCR data
dplyr::distinct(labels, .keep_all = TRUE)-> challenge.DNA
challenge.DNA%>%
dplyr::mutate(Genome_copies_ngDNA= Genome_copies/50, ## copies by ng of fecal DNA considering 1uL from 50 ng/uL DNA
DNA_sample= Conc_DNA*40, ## Estimate total gDNA of sample considering 40uL of elution buffer
DNA_g_feces= DNA_sample/fecweight_DNA,
## Transform it to ng fecal DNA by g of faeces
Genome_copies_gFaeces= Genome_copies_ngDNA*DNA_g_feces) -> challenge.DNA.qpcr ## Estimate genome copies by g of faeces
#####NOTE: Out 0f 73 samples 68 are calculated -> check 5 missing samples
View(challenge.DNA.qpcr)
##BEGIN with qPCR Data
if(!exists("challenge.DNA.qpcr")){
source("R_Python_Scripts/2_Challange_infections/2_qPCR_Data_Prep.R")
}
##BEGIN with qPCR Data
if(!exists("challenge.DNA.qpcr")){
source("R_Python_Scripts/2_Challange_infections/2_qPCR_Data_Prep.R")
}
##BEGIN with qPCR Data
if(!exists("challenge.DNA.qpcr")){
source("R_Python_Scripts/2_Challange_infections/2_qPCR_Data_Prep.R")
}
##BEGIN with qPCR Data
if(!exists("challenge.DNA.qpcr")){
source("R_Python_Scripts/2_Challange_infections/2_qPCR_Data_Prep.R")
}
##BEGIN with qPCR Data
if(!exists("challenge.DNA.qpcr")){
source("R_Python_Scripts/2_Challange_infections/2_qPCR_Data_Prep.R")
}
##BEGIN with qPCR Data
if(!exists("challenge.DNA.qpcr")){
source("R_Python_Scripts/2_Challange_infections/2_qPCR_Data_Prep.R")
}
##BEGIN with qPCR Data
if(!exists("challenge.DNA.qpcr")){
source("R_Python_Scripts/2_Challange_infections/2_qPCR_Data_Prep.R")
}
##BEGIN with qPCR Data
if(!exists("challenge.DNA.qpcr")){
source("R_Python_Scripts/2_Challange_infections/2_qPCR_Data_Prep.R")
}
##BEGIN with qPCR Data
if(!exists("challenge.DNA.qpcr")){
source("R_Python_Scripts/2_Challange_infections/2_qPCR_Data_Prep.R")
}
##BEGIN with qPCR Data
if(!exists("challenge.DNA.qpcr")){
source("R_Python_Scripts/2_Challange_infections/2_qPCR_Data_Prep.R")
}
##BEGIN with qPCR Data
if(!exists("challenge.DNA.qpcr")){
source("R_Python_Scripts/2_Challange_infections/2_qPCR_Data_Prep.R")
}
##BEGIN with qPCR Data
if(!exists("challenge.DNA.qpcr")){
source("R_Python_Scripts/2_Challange_infections/2_qPCR_Data_Prep.R")
}
if(!exists("challenge.DNA.qpcr")){
source("R_Python_Scripts/2_Challange_infections/2_qPCR_Data_Prep.R")
}
##BEGIN with qPCR Data
if(!exists("challenge.DNA.qpcr")){
source("R_Python_Scripts/2_Challange_infections/2_qPCR_Data_Prep.R")
}
if(!exists("challenge.DNA.qpcr")){
source("R_Python_Scripts/2_Challange_infections/2_qPCR_Data_Prep.R")
}
##BEGIN with qPCR Data
if(!exists("challenge.DNA")){
source("R_Python_Scripts/2_Challange_infections/2_qPCR_Data_Prep.R")
}
if(!exists("challenge.DNA.qpcr")){
source("R_Python_Scripts/2_Challange_infections/2_qPCR_Data_Prep.R")
}
##BEGIN with qPCR Data
if(!exists("challenge.DNA")){
source("R_Python_Scripts/2_Challange_infections/2_qPCR_Data_Prep.R")
}
if(!exists("challenge.DNA")){
source("R_Python_Scripts/2_Challange_infections/2_qPCR_Data_Prep.R")
}
View(challenge.DNA)
##Genome copies/g of faeces
##Wilcoxon test (Compare mean per DPI with DPI 0 as reference)
challenge.DNA.qpcr%>%
filter(dpi%in%c("0","1","2","3","4", "5","6", "7", "8"))%>%
dplyr::select(EH_ID, dpi, Genome_copies_gFaeces)%>%
dplyr::arrange(EH_ID)%>%
dplyr::arrange(dpi)%>% ##for comparison
filter(!is.na(Genome_copies_gFaeces))%>%
wilcox_test(Genome_copies_gFaeces ~ dpi, alternative = "two.sided", ref.group = "0")%>%
adjust_pvalue(method = "bonferroni") %>%
add_significance()%>%
add_xy_position(x = "dpi")-> stats.test
##Genome copies/g of faeces
##Wilcoxon test (Compare mean per DPI with DPI 0 as reference)
challenge.DNA%>%
filter(dpi%in%c("0","1","2","3","4", "5","6", "7", "8"))%>%
dplyr::select(EH_ID, dpi, Genome_copies_gFaeces)%>%
dplyr::arrange(EH_ID)%>%
dplyr::arrange(dpi)%>% ##for comparison
filter(!is.na(Genome_copies_gFaeces))%>%
wilcox_test(Genome_copies_gFaeces ~ dpi, alternative = "two.sided", ref.group = "0")%>%
adjust_pvalue(method = "bonferroni") %>%
add_significance()%>%
add_xy_position(x = "dpi")-> stats.test
##Save statistical analysis
x <- stats.test
x$groups<- NULL
stats.test%>%
dplyr::mutate(y.position = log10(y.position))%>%
dplyr::mutate(dpi = c("1","2","3","4", "5","6", "7", "8"))-> stats.test
#Let me try my own plot
ggplot(challenge.DNA, aes(dpi, Genome_copies_gFaeces, colour = dpi,shape = Infection)) +
geom_point()
#Let me try my own plot
ggplot(challenge.DNA, aes(dpi, Genome_copies_gFaeces,shape = Infection)) +
geom_point() +
scale_color_manual(values=c("#999999", "#E69F00", "#56B4E9"))+
labs(title="qPCR results of challenge infection", x="Day Post Infection", y="Price")
#Let me try my own plot
ggplot(challenge.DNA, aes(dpi, Genome_copies_gFaeces, colour = dpi,shape = Infection)) +
geom_point() +
labs(title="qPCR results of challenge infection", x="Day Post Infection", y="Price")
#Let me try my own plot
ggplot(challenge.DNA, aes(dpi, Genome_copies_gFaeces, colour = dpi,shape = Infection)) +
geom_point() +
scale_color_manual(values=c("#f66d9b", "#9561e2", "#6574cd","#3490dc","#4dc0b5","#38c172","#ffed4a","#f6993f","#e3342f"))
#Let me try my own plot
ggplot(challenge.DNA, aes(dpi, Genome_copies_gFaeces, colour = dpi,shape = Infection)) +
geom_point() +
scale_color_manual(values=c("#f66d9b", "#9561e2", "#6574cd","#3490dc","#4dc0b5","#38c172","#ffed4a","#f6993f","#e3342f"))+
labs(title="qPCR results of challenge infection", x="Day Post Infection", y="Price")
#Let me try my own plot
ggplot(challenge.DNA, aes(dpi, Genome_copies_gFaeces,shape = Infection)) +
geom_point() +
scale_color_manual(values=c("#f66d9b", "#9561e2", "#6574cd","#3490dc","#4dc0b5","#38c172","#ffed4a","#f6993f","#e3342f"))+
labs(title="qPCR results of challenge infection", x="Day Post Infection", y="Price")
#Let me try my own plot
ggplot(challenge.DNA, aes(dpi, Genome_copies_gFaeces,shape = Infection)) +
geom_point() +
scale_color_manual(values=c("#f66d9b", "#9561e2", "#6574cd","#3490dc","#4dc0b5","#38c172","#ffed4a","#f6993f","#e3342f"))+
labs(title="qPCR results of challenge infection", x="Day Post Infection", y="Price") ->qPCR
#Let me try my own plot
ggplot(challenge.DNA, aes(dpi, Genome_copies_gFaeces,shape = Infection)) +
geom_point() +
scale_color_manual(values=c("#f66d9b", "#9561e2", "#6574cd","#3490dc","#4dc0b5","#38c172","#ffed4a","#f6993f","#e3342f"))+
labs(title="qPCR results of challenge infection", x="Day Post Infection", y="Price") ->qPCR
#Let me try my own plot
ggplot(challenge.DNA, aes(dpi, Genome_copies_gFaeces,shape = Infection)) +
geom_point() +
scale_fill_manual(values=c("#f66d9b", "#9561e2", "#6574cd","#3490dc","#4dc0b5","#38c172","#ffed4a","#f6993f","#e3342f"))+
labs(title="qPCR results of challenge infection", x="Day Post Infection", y="Price") ->qPCR
#Let me try my own plot
ggplot(challenge.DNA, aes(dpi, Genome_copies_gFaeces,shape = Infection)) +
geom_point() +
scale_fill_manual(values=c("#f66d9b", "#9561e2", "#6574cd","#3490dc","#4dc0b5","#38c172","#ffed4a","#f6993f","#e3342f"))+
labs(title="qPCR results of challenge infection", x="Day Post Infection", y="Price") ->qPCR
#Let me try my own plot
ggplot(challenge.DNA, aes(dpi, Genome_copies_gFaeces,color = dpi, shape = Infection)) +
geom_point() +
scale_fill_manual(values=c("#f66d9b", "#9561e2", "#6574cd","#3490dc","#4dc0b5","#38c172","#ffed4a","#f6993f","#e3342f"))+
labs(title="qPCR results of challenge infection", x="Day Post Infection", y="Price") ->qPCR
#Let me try my own plot
ggplot(challenge.DNA, aes(dpi, Genome_copies_gFaeces,color = dpi, shape = Infection)) +
geom_point() +
scale_fill_manual(values=c("#f66d9b", "#9561e2", "#6574cd","#3490dc","#4dc0b5","#38c172","#ffed4a","#f6993f","#e3342f"))+
labs(title="qPCR results of challenge infection", x="Day Post Infection", y="Price") ->qPCR
#Let me try my own plot
ggplot(challenge.DNA, aes(dpi, Genome_copies_gFaeces,fill = dpi, shape = Infection)) +
geom_point() +
scale_fill_manual(values=c("#f66d9b", "#9561e2", "#6574cd","#3490dc","#4dc0b5","#38c172","#ffed4a","#f6993f","#e3342f"))+
labs(title="qPCR results of challenge infection", x="Day Post Infection", y="Price") ->qPCR
#Let me try my own plot
ggplot(challenge.DNA, aes(dpi, Genome_copies_gFaeces, colour = dpi,shape = Infection)) +
geom_point() +
scale_color_manual(values=c("#f66d9b", "#9561e2", "#6574cd","#3490dc","#4dc0b5","#38c172","#ffed4a","#f6993f","#e3342f"))+
labs(title="qPCR results of challenge infection", x="Day Post Infection", y="Price")
class(challenge.DNA$dpi)
#Let me try my own plot
ggplot(challenge.DNA, aes(dpi, Genome_copies_gFaeces, colour = dpi,shape = Infection)) +
geom_point() +
scale_color_manual(values=c("#f66d9b", "#9561e2", "#6574cd","#3490dc","#4dc0b5","#38c172","#ffed4a","#f6993f","#e3342f"))+
labs(title="qPCR results of challenge infection", x="Day Post Infection", y="Price")
#Let me try my own plot
ggplot(challenge.DNA, aes(dpi, Genome_copies_gFaeces, colour = dpi,shape = Infection)) +
geom_point() +
scale_fill_manual(values=c("#f66d9b", "#9561e2", "#6574cd","#3490dc","#4dc0b5","#38c172","#ffed4a","#f6993f","#e3342f"))+
labs(title="qPCR results of challenge infection", x="Day Post Infection", y="Price")
#Let me try my own plot
ggplot(challenge.DNA, aes(dpi, Genome_copies_gFaeces, colour = dpi,shape = Infection)) +
geom_point() +
scale_color_manual(values=c("#f66d9b", "#9561e2", "#6574cd","#3490dc","#4dc0b5","#38c172","#ffed4a","#f6993f","#e3342f"))+
labs(title="qPCR results of challenge infection", x="Day Post Infection", y="Price")
#Let me try my own plot
ggplot(challenge.DNA, aes(dpi, Genome_copies_gFaeces,shape = Infection)) +
geom_point(fill=dpi) +
scale_color_manual(values=c("#f66d9b", "#9561e2", "#6574cd","#3490dc","#4dc0b5","#38c172","#ffed4a","#f6993f","#e3342f"))+
labs(title="qPCR results of challenge infection", x="Day Post Infection", y="Price")
#Let me try my own plot
ggplot(challenge.DNA, aes(dpi, Genome_copies_gFaeces,shape = Infection)) +
geom_point(fill=dpi) +
scale_color_manual(values=c("#f66d9b", "#9561e2", "#6574cd","#3490dc","#4dc0b5","#38c172","#ffed4a","#f6993f","#e3342f"))+
labs(title="qPCR results of challenge infection", x="Day Post Infection", y="Price")
#Let me try my own plot
ggplot(challenge.DNA, aes(dpi, Genome_copies_gFaeces,shape = Infection)) +
geom_point(aes(fill=dpi)) +
scale_color_manual(values=c("#f66d9b", "#9561e2", "#6574cd","#3490dc","#4dc0b5","#38c172","#ffed4a","#f6993f","#e3342f"))+
labs(title="qPCR results of challenge infection", x="Day Post Infection", y="Price")
manual = c("#f66d9b", "#9561e2", "#6574cd","#3490dc","#4dc0b5","#38c172","#ffed4a","#f6993f","#e3342f")
#Let me try my own plot
ggplot(challenge.DNA, aes(dpi, Genome_copies_gFaeces,shape = Infection)) +
geom_point(colour="manual") +
labs(title="qPCR results of challenge infection", x="Day Post Infection", y="Price")
#Let me try my own plot
ggplot(challenge.DNA, aes(dpi, Genome_copies_gFaeces,shape = Infection)) +
geom_point(colour=("#f66d9b", "#9561e2", "#6574cd","#3490dc","#4dc0b5","#38c172","#ffed4a","#f6993f","#e3342f")) +
labs(title="qPCR results of challenge infection", x="Day Post Infection", y="Price")
#Let me try my own plot
ggplot(challenge.DNA, aes(dpi, Genome_copies_gFaeces,shape = Infection)) +
geom_point(colour=("#f66d9b", "#9561e2", "#6574cd","#3490dc","#4dc0b5","#38c172","#ffed4a","#f6993f","#e3342f")) +
labs(title="qPCR results of challenge infection", x="Day Post Infection", y="Price")
#Let me try my own plot
ggplot(challenge.DNA, aes(dpi, Genome_copies_gFaeces,shape = Infection)) +
geom_point(colour="#f66d9b", "#9561e2", "#6574cd","#3490dc","#4dc0b5","#38c172","#ffed4a","#f6993f","#e3342f") +
labs(title="qPCR results of challenge infection", x="Day Post Infection", y="Price")
#Let me try my own plot
ggplot(challenge.DNA, aes(dpi, Genome_copies_gFaeces,shape = Infection)) +
geom_point(colour="#f66d9b", "#9561e2", "#6574cd","#3490dc","#4dc0b5","#38c172","#ffed4a","#f6993f","#e3342f") +
labs(title="qPCR results of challenge infection", x="Day Post Infection", y="Price")
#Let me try my own plot
ggplot(challenge.DNA, aes(dpi, Genome_copies_gFaeces,shape = Infection)) +
geom_point(colour="manual") +
scale_color_manual(values=c("#f66d9b", "#9561e2", "#6574cd","#3490dc","#4dc0b5","#38c172","#ffed4a","#f6993f","#e3342f"))+
labs(title="qPCR results of challenge infection", x="Day Post Infection", y="Price")
#Let me try my own plot
ggplot(challenge.DNA, aes(dpi, Genome_copies_gFaeces, colour = dpi,shape = Infection)) +
geom_point() +
scale_color_manual(values=c("#f66d9b", "#9561e2", "#6574cd","#3490dc","#4dc0b5","#38c172","#ffed4a","#f6993f","#e3342f"))+
labs(title="qPCR results of challenge infection", x="Day Post Infection", y="Price")
#Let me try my own plot
ggplot(challenge.DNA, aes(dpi, Genome_copies_gFaeces, colour = factor(dpi),shape = Infection)) +
geom_point() +
scale_color_manual(values=c("#f66d9b", "#9561e2", "#6574cd","#3490dc","#4dc0b5","#38c172","#ffed4a","#f6993f","#e3342f"))+
labs(title="qPCR results of challenge infection", x="Day Post Infection", y="Price")
#Let me try my own plot
ggplot(challenge.DNA, aes(dpi, Genome_copies_gFaeces, colour = factor(dpi),shape = Infection)) +
geom_point() +
scale_color_manual(values=c("#f66d9b", "#9561e2", "#6574cd","#3490dc","#4dc0b5","#38c172","#ffed4a","#f6993f","#e3342f"))+
labs(title="qPCR results of challenge infection", x="Day Post Infection", y="log10 (Genome copies/g Faeces + 1) (qPCR)")
#Let me try my own plot
ggplot(challenge.DNA, aes(dpi, Genome_copies_gFaeces+1, colour = factor(dpi),shape = Infection)) +
geom_point() +
scale_color_manual(values=c("#f66d9b", "#9561e2", "#6574cd","#3490dc","#4dc0b5","#38c172","#ffed4a","#f6993f","#e3342f"))+
labs(title="qPCR results of challenge infection", x="Day Post Infection", y="log10 (Genome copies/g Faeces + 1) (qPCR)")+
scale_y_log10("log10 (Genome copies/g Faeces + 1) (qPCR)",
breaks = scales::trans_breaks("log10", function(x) 10^x),
labels = scales::trans_format("log10", scales::math_format(10^.x)))+
challenge.DNA%>%
filter(dpi%in%c("0","1","2","3","4", "5","6", "7", "8"))%>%
dplyr::select(EH_ID, dpi, Genome_copies_gFaeces, Infection)%>%
dplyr::arrange(EH_ID)%>%
dplyr::arrange(dpi)%>% ##for comparison
filter(!is.na(Genome_copies_gFaeces))%>%
#filter(Genome_copies_gFaeces!=0)%>%
ggplot(aes(x= dpi, y= Genome_copies_gFaeces+1, color=dpi))+
scale_y_log10("log10 (Genome copies/g Faeces + 1) (qPCR)",
breaks = scales::trans_breaks("log10", function(x) 10^x),
labels = scales::trans_format("log10", scales::math_format(10^.x)))+
geom_boxplot()+
geom_point(position=position_jitter(0.2), size=2.5, aes(shape= Infection, fill=dpi))+
scale_shape_manual(values = c(21, 24))+
xlab("Day post infection")+
geom_line(aes(group = EH_ID), color= "gray", alpha= 0.5)+
labs(tag= "a", shape= "qPCR status (Melting curve)")+
theme_bw()+
theme(text = element_text(size=16), axis.title.x = element_blank(), legend.position = "top")+
annotation_logticks(sides = "l")+
guides(fill=FALSE)+
stat_pvalue_manual(stats.test, label= "p.adj.signif", x= "dpi", y.position = 100000000000)-> A
#Let me try my own plot
ggplot(challenge.DNA, aes(dpi, Genome_copies_gFaeces+1, colour = factor(dpi),shape = Infection)) +
geom_point() +
scale_color_manual(values=c("#f66d9b", "#9561e2", "#6574cd","#3490dc","#4dc0b5","#38c172","#ffed4a","#f6993f","#e3342f"))+
labs(title="qPCR results of challenge infection", x="Day Post Infection", y="log10 (Genome copies/g Faeces + 1) (qPCR)")+
scale_y_log10("log10 (Genome copies/g Faeces + 1) (qPCR)",
breaks = scales::trans_breaks("log10", function(x) 10^x),
labels = scales::trans_format("log10", scales::math_format(10^.x)))+
challenge.DNA%>%
filter(dpi%in%c("0","1","2","3","4", "5","6", "7", "8"))%>%
dplyr::select(EH_ID, dpi, Genome_copies_gFaeces, Infection)%>%
dplyr::arrange(EH_ID)%>%
dplyr::arrange(dpi)%>% ##for comparison
filter(!is.na(Genome_copies_gFaeces))%>%
#filter(Genome_copies_gFaeces!=0)%>%
ggplot(aes(x= dpi, y= Genome_copies_gFaeces+1, color=dpi))+
scale_y_log10("log10 (Genome copies/g Faeces + 1) (qPCR)",
breaks = scales::trans_breaks("log10", function(x) 10^x),
labels = scales::trans_format("log10", scales::math_format(10^.x)))+
geom_boxplot()+
geom_point(position=position_jitter(0.2), size=2.5, aes(shape= Infection, fill=dpi))+
scale_shape_manual(values = c(21, 24))+
xlab("Day post infection")+
geom_line(aes(group = EH_ID), color= "gray", alpha= 0.5)+
labs(tag= "a", shape= "qPCR status (Melting curve)")+
theme_bw()+
theme(text = element_text(size=16), axis.title.x = element_blank(), legend.position = "top")+
annotation_logticks(sides = "l")+
guides(fill=FALSE)+
stat_pvalue_manual(stats.test, label= "p.adj.signif", x= "dpi", y.position = 100000000000)-> A
#Let me try my own plot
ggplot(challenge.DNA, aes(dpi, Genome_copies_gFaeces+1, colour = factor(dpi),shape = Infection)) +
geom_point() +
scale_color_manual(values=c("#f66d9b", "#9561e2", "#6574cd","#3490dc","#4dc0b5","#38c172","#ffed4a","#f6993f","#e3342f"))+
labs(title="qPCR results of challenge infection", x="Day Post Infection", y="log10 (Genome copies/g Faeces + 1) (qPCR)")+
scale_y_continuous(trans='log10')
#Let me try my own plot
challenge.DNA%>%
filter(Genome_copies_gFaeces!=0)%>%
ggplot(challenge.DNA, aes(dpi, Genome_copies_gFaeces+1, colour = factor(dpi),shape = Infection))+
geom_point() +
scale_color_manual(values=c("#f66d9b", "#9561e2", "#6574cd","#3490dc","#4dc0b5","#38c172","#ffed4a","#f6993f","#e3342f"))+
labs(title="qPCR results of challenge infection", x="Day Post Infection", y="log10 (Genome copies/g Faeces + 1) (qPCR)")+
scale_y_continuous(trans='log10')
#Let me try my own plot
challenge.DNA%>%
filter(Genome_copies_gFaeces!=0)%>%
ggplot( aes(dpi, Genome_copies_gFaeces+1, colour = factor(dpi),shape = Infection))+
geom_point() +
scale_color_manual(values=c("#f66d9b", "#9561e2", "#6574cd","#3490dc","#4dc0b5","#38c172","#ffed4a","#f6993f","#e3342f"))+
labs(title="qPCR results of challenge infection", x="Day Post Infection", y="log10 (Genome copies/g Faeces + 1) (qPCR)")+
scale_y_continuous(trans='log10')
#Let me try my own plot
challenge.DNA%>%
filter(dpi%in%c("0","1","2","3","4", "5","6", "7", "8"))%>%
dplyr::select(EH_ID, dpi, Genome_copies_gFaeces, Infection)%>%
filter(Genome_copies_gFaeces!=0)%>%
ggplot( aes(dpi, Genome_copies_gFaeces+1, colour = factor(dpi),shape = Infection))+
geom_point() +
scale_color_manual(values=c("#f66d9b", "#9561e2", "#6574cd","#3490dc","#4dc0b5","#38c172","#ffed4a","#f6993f","#e3342f"))+
labs(title="qPCR results of challenge infection", x="Day Post Infection", y="log10 (Genome copies/g Faeces + 1) (qPCR)")+
scale_y_continuous(trans='log10')
#Let me try my own plot
challenge.DNA%>%
filter(dpi%in%c("0","1","2","3","4", "5","6", "7", "8"))%>%
dplyr::select(EH_ID, dpi, Genome_copies_gFaeces, Infection)%>%
filter(Genome_copies_gFaeces!=0)%>%
ggplot( aes(dpi, Genome_copies_gFaeces+1, colour = factor(dpi), shape = Infection))+
geom_point() +
scale_color_manual(values=c("#f66d9b", "#9561e2", "#6574cd","#3490dc","#4dc0b5","#38c172","#ffed4a","#f6993f","#e3342f"))+
labs(title="qPCR results of challenge infection", x="Day Post Infection", y="log10 (Genome copies/g Faeces + 1) (qPCR)")+
scale_y_continuous(trans='log10')
#Let me try my own plot
challenge.DNA%>%
filter(dpi%in%c("0","1","2","3","4", "5","6", "7", "8"))%>%
dplyr::select(EH_ID, dpi, Genome_copies_gFaeces, Infection)%>%
filter(Genome_copies_gFaeces!=0)%>%
ggplot(aes(dpi, Genome_copies_gFaeces+1, colour = factor(dpi), shape = Infection))+
geom_point(aes(shape=Infection)) +
scale_color_manual(values=c("#f66d9b", "#9561e2", "#6574cd","#3490dc","#4dc0b5","#38c172","#ffed4a","#f6993f","#e3342f"))+
labs(title="qPCR results of challenge infection", x="Day Post Infection", y="log10 (Genome copies/g Faeces + 1) (qPCR)")+
scale_y_continuous(trans='log10')
#Let me try my own plot
challenge.DNA%>%
dplyr::select(EH_ID, dpi, Genome_copies_gFaeces, Infection)%>%
filter(dpi%in%c("0","1","2","3","4", "5","6", "7", "8"))%>%
filter(Genome_copies_gFaeces!=0)%>%
ggplot(aes(dpi, Genome_copies_gFaeces+1, colour = factor(dpi), shape = Infection))+
geom_point(aes(shape=Infection)) +
scale_color_manual(values=c("#f66d9b", "#9561e2", "#6574cd","#3490dc","#4dc0b5","#38c172","#ffed4a","#f6993f","#e3342f"))+
labs(title="qPCR results of challenge infection", x="Day Post Infection", y="log10 (Genome copies/g Faeces + 1) (qPCR)")+
scale_y_continuous(trans='log10')
#Let me try my own plot
challenge.DNA%>%
dplyr::select(EH_ID, dpi, Genome_copies_gFaeces, Infection)%>%
filter(dpi%in%c("0","1","2","3","4", "5","6", "7", "8"))%>%
filter(!is.na(Genome_copies_gFaeces))%>%
ggplot(aes(dpi, Genome_copies_gFaeces+1, colour = factor(dpi), shape = Infection))+
geom_point(aes(shape=Infection)) +
scale_color_manual(values=c("#f66d9b", "#9561e2", "#6574cd","#3490dc","#4dc0b5","#38c172","#ffed4a","#f6993f","#e3342f"))+
labs(title="qPCR results of challenge infection", x="Day Post Infection", y="log10 (Genome copies/g Faeces + 1) (qPCR)")+
scale_y_continuous(trans='log10')
#Let me try my own plot
challenge.DNA%>%
dplyr::select(EH_ID, dpi, Genome_copies_gFaeces, Infection)%>%
filter(dpi%in%c("0","1","2","3","4", "5","6", "7", "8"))%>%
filter(!is.na(Genome_copies_gFaeces))%>%
filter(!is.na(Infection))%>%
ggplot(aes(dpi, Genome_copies_gFaeces+1, colour = factor(dpi), shape = Infection))+
geom_point(aes(shape=Infection)) +
scale_color_manual(values=c("#f66d9b", "#9561e2", "#6574cd","#3490dc","#4dc0b5","#38c172","#ffed4a","#f6993f","#e3342f"))+
labs(title="qPCR results of challenge infection", x="Day Post Infection", y="log10 (Genome copies/g Faeces + 1) (qPCR)")+
scale_y_continuous(trans='log10')
#Let me try my own plot
challenge.DNA%>%
dplyr::select(EH_ID, dpi, Genome_copies_gFaeces, Infection)%>%
filter(dpi%in%c("0","1","2","3","4", "5","6", "7", "8"))%>%
filter(!is.na(Genome_copies_gFaeces))%>%
filter(!is.na(Infection))%>%
ggplot(aes(dpi, Genome_copies_gFaeces+1, colour = factor(dpi), shape = Infection))+
geom_point(aes(shape=Infection)) +
scale_color_manual(values=c("#f66d9b", "#9561e2", "#6574cd","#3490dc","#4dc0b5","#38c172","#ffed4a","#f6993f","#e3342f"))+
labs(title="qPCR results of challenge infection", x="Day Post Infection", y="log10 (Genome copies/g Faeces + 1) (qPCR)")+
scale_y_continuous(trans='log10'),
breaks = scales::trans_breaks("log10", function(x) 10^x),
labels = scales::trans_format("log10", scales::math_format(10^.x)))
#Let me try my own plot
challenge.DNA%>%
dplyr::select(EH_ID, dpi, Genome_copies_gFaeces, Infection)%>%
filter(dpi%in%c("0","1","2","3","4", "5","6", "7", "8"))%>%
filter(!is.na(Genome_copies_gFaeces))%>%
filter(!is.na(Infection))%>%
ggplot(aes(dpi, Genome_copies_gFaeces+1, colour = factor(dpi), shape = Infection))+
geom_point(aes(shape=Infection)) +
scale_color_manual(values=c("#f66d9b", "#9561e2", "#6574cd","#3490dc","#4dc0b5","#38c172","#ffed4a","#f6993f","#e3342f"))+
labs(title="qPCR results of challenge infection", x="Day Post Infection", y="log10 (Genome copies/g Faeces + 1) (qPCR)")+
scale_y_continuous((trans='log10'),
breaks = scales::trans_breaks("log10", function(x) 10^x),
labels = scales::trans_format("log10", scales::math_format(10^.x)))
#Let me try my own plot
challenge.DNA%>%
dplyr::select(EH_ID, dpi, Genome_copies_gFaeces, Infection)%>%
filter(dpi%in%c("0","1","2","3","4", "5","6", "7", "8"))%>%
filter(!is.na(Genome_copies_gFaeces))%>%
filter(!is.na(Infection))%>%
ggplot(aes(dpi, Genome_copies_gFaeces+1, colour = factor(dpi), shape = Infection))+
geom_point(aes(shape=Infection)) +
scale_color_manual(values=c("#f66d9b", "#9561e2", "#6574cd","#3490dc","#4dc0b5","#38c172","#ffed4a","#f6993f","#e3342f"))+
labs(title="qPCR results of challenge infection", x="Day Post Infection", y="log10 (Genome copies/g Faeces + 1) (qPCR)")+
scale_y_log10(breaks = scales::trans_breaks("log10", function(x) 10^x),
labels = scales::trans_format("log10", scales::math_format(10^.x)))
